# Fleet Tracker MQTT Access Control List
# Production ACL configuration for secure topic access

# =============================================================================
# Admin Users (Full Access)
# =============================================================================

user fleet_admin
topic readwrite #

user backend_service
topic readwrite fleet/#
topic readwrite $SYS/#

# =============================================================================
# Vehicle Device Access
# =============================================================================

# Pattern for vehicle devices: fleet_device_{vehicle_id}
# Each device can only access its own topics

# Vehicle can publish location updates
pattern write fleet/%u/location
pattern write fleet/%u/status
pattern write fleet/%u/heartbeat

# Vehicle can read system broadcasts
pattern read fleet/broadcast

# Vehicle can read its own configuration
pattern read fleet/%u/config

# =============================================================================
# Frontend Client Access
# =============================================================================

# Frontend clients (read-only for most topics)
user fleet_frontend
topic read fleet/+/location
topic read fleet/+/status
topic read fleet/+/alerts
topic read fleet/broadcast

# =============================================================================
# System Topics
# =============================================================================

# System monitoring (admin only)
topic read $SYS/broker/load/+
topic read $SYS/broker/clients/+
topic read $SYS/broker/messages/+

# =============================================================================
# Default Policy
# =============================================================================

# Deny all other access by default
# (This is implicit in Mosquitto when using ACL files)
